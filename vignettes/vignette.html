<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>rglobi vignette - an R interface to the aggregated biotic interaction data of GloBI (<a href="http://globalbioticinteractions.org">http://globalbioticinteractions.org</a>)</title>





<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}

pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{rglobi vignette}
-->

<h1>rglobi vignette - an R interface to the aggregated biotic interaction data of GloBI (<a href="http://globalbioticinteractions.org">http://globalbioticinteractions.org</a>)</h1>

<h3>About the package</h3>

<p><code>rglobi</code> allows easy access to the GLoBI database by wrapping the existing API.  </p>

<hr/>

<h3>Quick start</h3>

<h4>First, install <code>rglobi</code></h4>

<pre><code class="r">install.packages(&quot;devtools&quot;)
</code></pre>

<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/v4/0_y78_xj1x7b72l89cwc2kq80000gp/T//RtmpY8t5MY/downloaded_packages
</code></pre>

<pre><code class="r">devtools::install_github(&quot;rglobi&quot;, &quot;ropensci&quot;)
</code></pre>

<pre><code>## Installing github repo rglobi/master from ropensci
## Downloading master.zip from https://github.com/ropensci/rglobi/archive/master.zip
## Installing package from /var/folders/v4/0_y78_xj1x7b72l89cwc2kq80000gp/T//RtmpY8t5MY/master.zip
## arguments &#39;minimized&#39; and &#39;invisible&#39; are for Windows only
## Installing rglobi
## &#39;/Library/Frameworks/R.framework/Resources/bin/R&#39; --vanilla CMD build  \
##   &#39;/private/var/folders/v4/0_y78_xj1x7b72l89cwc2kq80000gp/T/RtmpY8t5MY/devtoolsaa601ff04183/rglobi-master&#39;  \
##   --no-manual --no-resave-data 
## 
## &#39;/Library/Frameworks/R.framework/Resources/bin/R&#39; --vanilla CMD INSTALL  \
##   &#39;/var/folders/v4/0_y78_xj1x7b72l89cwc2kq80000gp/T//RtmpY8t5MY/rglobi_0.1.tar.gz&#39;  \
##   --library=&#39;/Library/Frameworks/R.framework/Versions/3.0/Resources/library&#39;  \
##   --install-tests 
## 
## Reloading installed rglobi
## 
## Attaching package: &#39;rglobi&#39;
## 
## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     get_interactions_in_area
</code></pre>

<pre><code class="r">library(&quot;rglobi&quot;)
</code></pre>

<p>Note that since rglobi is still pretty new, only the dev version of the library is available at this time. We hope to publish a version to CRAN once the library matures. For more information see <a href="https://github.com/ropensci/rglobi">GitHub</a>.</p>

<h4>Find interactions involving a certain species</h4>

<p>Determining which species interact with each other (and how and where) is a major focus of ecology.  The Global Biotic Interactions Database offers data on multiple interaction types, and the rglobi library offers several ways to specify and access these interactions.  get_interactions is the primary function used if data on a specific interaction type is required.  A focus taxon is entered (may be specified as &quot;Genus species&quot; or higher level (e.g., Genus, Family, Class)).</p>

<pre><code class="r">hsapiens &lt;- get_interactions(taxon = &quot;Homo sapiens&quot;, interaction.type = &quot;preysOn&quot;)
head(hsapiens)
</code></pre>

<pre><code>##   source_taxon_name interaction_type   target_taxon_name
## 1      Homo sapiens          preysOn        Homo sapiens
## 2      Homo sapiens          preysOn  Macropus bernardus
## 3      Homo sapiens          preysOn           Mysticeti
## 4      Homo sapiens          preysOn Dendrolagus scottae
## 5      Homo sapiens          preysOn Engraulis japonicus
## 6      Homo sapiens          preysOn       Sergia lucens
</code></pre>

<p>get_predators_of and get_prey_of are wrappers for get_interactions that remove the need to specify interaction type</p>

<pre><code class="r">hsapiens &lt;- get_prey_of(&quot;Homo sapiens&quot;)
head(hsapiens)
</code></pre>

<pre><code>##   source_taxon_name interaction_type   target_taxon_name
## 1      Homo sapiens          preysOn        Homo sapiens
## 2      Homo sapiens          preysOn  Macropus bernardus
## 3      Homo sapiens          preysOn           Mysticeti
## 4      Homo sapiens          preysOn Dendrolagus scottae
## 5      Homo sapiens          preysOn Engraulis japonicus
## 6      Homo sapiens          preysOn       Sergia lucens
</code></pre>

<p>For a complete list of supported interaction types, </p>

<pre><code class="r">get_interaction_types()
</code></pre>

<pre><code>## Warning: incomplete final line found by readTableHeader on
## &#39;http://api.globalbioticinteractions.org:80/interactionTypes&#39;
</code></pre>

<pre><code>##    Interaction   Source   Target
## 1      preysOn predator     prey
## 2 preyedUponBy     prey predator
## 3   parasiteOf parasite     host
## 4       hostOf     host parasite
</code></pre>

<p>For data sources in which type of interactions was not specified, the interaction is labeled &quot;interacts_with&quot;.</p>

<p>If you wish to view all interactions instead of specific types (e.g., parasitism and predation instead of just one of the two), the get_interactions_by_taxa allows this. In addition, the function provides options to search for interactions between two groups (source and target taxa, see above table) and only find interactions in a certain region.</p>

<pre><code class="r">rattus &lt;- get_interactions_by_taxa(sourcetaxon = &quot;Rattus&quot;)
head(rattus)
</code></pre>

<pre><code>##   source_taxon_external_id source_taxon_name
## 1               EOL:328447     Rattus rattus
## 2               EOL:328447     Rattus rattus
## 3               EOL:328447     Rattus rattus
## 4               EOL:328447     Rattus rattus
## 5               EOL:328447     Rattus rattus
## 6               EOL:328447     Rattus rattus
##                                                              source_taxon_path
## 1 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
## 2 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
## 3 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
## 4 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
## 5 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
## 6 Animalia | Chordata | Mammalia | Rodentia | Muridae | Rattus | Rattus rattus
##   interaction_type target_taxon_external_id
## 1              ATE               EOL:330973
## 2              ATE               EOL:330977
## 3              ATE              EOL:1019109
## 4              ATE              EOL:1019106
## 5              ATE               EOL:330433
## 6              ATE               EOL:330945
##                 target_taxon_name
## 1 Eleutherodactylus portoricensis
## 2    Eleutherodactylus wightmanae
## 3       Eleutherodactylus eneidae
## 4      Eleutherodactylus hedricki
## 5         Eleutherodactylus coqui
## 6     Eleutherodactylus richmondi
##                                                                                                    target_taxon_path
## 1 Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus portoricensis
## 2    Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus wightmanae
## 3       Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus eneidae
## 4      Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus hedricki
## 5         Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus coqui
## 6     Animalia | Chordata | Amphibia | Anura | Eleutherodactylidae | Eleutherodactylus | Eleutherodactylus richmondi
</code></pre>

<p>Only a source taxa need be identified, but you can also specify a target taxon and/or geographic boundary (Coordinates must be in decimal degrees (<a href="http://spatialreference.org/ref/epsg/wgs-84/">EPSG:4326</a>) and correspond to the west, south, east, and northern boundaries (i.e., min x, min y, max x, max y).  </p>

<pre><code class="r">aves_crustacea_northern_hemisphere &lt;- get_interactions_by_taxa( sourcetaxon = &quot;Aves&quot;, targettaxon = &quot;Crustacea&quot;, bbox=c(-180, 0, 180, 90 ))
head(aves_crustacea_northern_hemisphere)
</code></pre>

<pre><code>##   source_taxon_external_id    source_taxon_name
## 1              EOL:1052686    Locustella naevia
## 2              EOL:1052686    Locustella naevia
## 3              EOL:1052686    Locustella naevia
## 4              EOL:1052686    Locustella naevia
## 5              EOL:1052686    Locustella naevia
## 6              EOL:1052775 Emberiza schoeniclus
##                                                                            source_taxon_path
## 1    Animalia | Chordata | Aves | Passeriformes | Sylviidae | Locustella | Locustella naevia
## 2    Animalia | Chordata | Aves | Passeriformes | Sylviidae | Locustella | Locustella naevia
## 3    Animalia | Chordata | Aves | Passeriformes | Sylviidae | Locustella | Locustella naevia
## 4    Animalia | Chordata | Aves | Passeriformes | Sylviidae | Locustella | Locustella naevia
## 5    Animalia | Chordata | Aves | Passeriformes | Sylviidae | Locustella | Locustella naevia
## 6 Animalia | Chordata | Aves | Passeriformes | Emberizidae | Emberiza | Emberiza schoeniclus
##   interaction_type target_taxon_external_id target_taxon_name
## 1       PREYS_UPON              EOL:4285684 Ligidium hypnorum
## 2       PREYS_UPON              EOL:4285684 Ligidium hypnorum
## 3       PREYS_UPON              EOL:4285684 Ligidium hypnorum
## 4       PREYS_UPON              EOL:4285684 Ligidium hypnorum
## 5       PREYS_UPON              EOL:4285684 Ligidium hypnorum
## 6       PREYS_UPON              EOL:4285684 Ligidium hypnorum
##                                                                                                                                                                                                                                                                                           target_taxon_path
## 1 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
## 2 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
## 3 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
## 4 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
## 5 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
## 6 Cellular organisms | Eukaryota | Opisthokonta | Metazoa | Eumetazoa | Bilateria | Protostomia | Ecdysozoa | Panarthropoda | Arthropoda | Mandibulata | Pancrustacea | Crustacea | Malacostraca | Eumalacostraca | Peracarida | Isopoda | Oniscidea | Diplocheta | Ligiidae | Ligidium | Ligidium hypnorum
</code></pre>

<h4>Find interactions in a geographic areas</h4>

<p>Instead of a taxon-specific approach, users may also wish to gather information on all interactions occuring in a specific area.  For example, a group developing ecoystem models for the Gulf of Mexico may want to consider all the data from that region.  rglobi enables this type of search by allowing users to specify a rectangular bounding box. Coordinates must be in decimal degrees (<a href="http://spatialreference.org/ref/epsg/wgs-84/">EPSG:4326</a>) and correspond to the west, south, east, and northern boundaries (i.e., min x, min y, max x, max y).  </p>

<pre><code class="r">gulfinteractions &lt;- get_interactions_in_area( bbox=c(-97.0, 17.5, -81, 31))
</code></pre>

<pre><code>## Error: could not find function &quot;get_globi_url&quot;
</code></pre>

<pre><code class="r">head(gulfinteractions)
</code></pre>

<pre><code>## [1] &quot;http://api.globalbioticinteractions.org:80/interaction?type=csv&amp;&quot;
</code></pre>

<p>To see all locations for which interactions have entered in GloBi, </p>

<pre><code class="r">areas &lt;- get_interaction_areas()
head(areas)
</code></pre>

<pre><code>##   Latitude Longitude
## 1    36.93   -118.68
## 2    50.40     -2.11
## 3    53.40     -0.59
## 4    53.42     -1.50
## 5   -25.00    135.00
## 6    40.98    -79.53
</code></pre>

<p>You can also restrict this search to a certain area:</p>

<pre><code class="r">areas &lt;- get_interaction_areas (bbox=c(-67.87,12.79,-57.08,23.32))
head(areas)
</code></pre>

<pre><code>##     Latitude Longitude
## 821    18.25    -66.50
## 826    18.34    -65.83
## 840    18.07    -63.07
## 914    13.17    -59.53
</code></pre>

<h4>Custom Queries using Cypher</h4>

<p>Currently, GloBI is powered by <a href="http://neo4j.org">neo4j</a>, a graph database. Most results created by the R functions provided by rglobi are basically wrappers for commonly used cypher queries. This way, you can still use the library without having to learn Cypher, a graph query language. However, if you feel adventurious, you can execute queries using Cypher only using the function query():</p>

<pre><code class="r">result &lt;- query(&quot;START taxon = node:taxons(name=&#39;Homo sapiens&#39;) MATCH taxon&lt;-[:CLASSIFIED_AS]-predator-[:ATE|PREYS_ON]-&gt;prey-[:CLASSIFIED_AS]-&gt;preyTaxon RETURN distinct(preyTaxon.name) as `prey.taxon.name` LIMIT 10&quot;)
result
</code></pre>

<pre><code>##         prey.taxon.name
## 1          Homo sapiens
## 2    Macropus bernardus
## 3             Mysticeti
## 4   Dendrolagus scottae
## 5   Engraulis japonicus
## 6         Sergia lucens
## 7       Martes melampus
## 8   Lophocebus albigena
## 9            Salmonidae
## 10 Moschus chrysogaster
</code></pre>

<p>This particular query returns the names of the first ten known prey or diet items of humans (<em>Homo sapiens</em>). More examples of GloBI specific Cypher queries can be found on the <a href="https://github.com/jhpoelen/eol-globi-data/wiki/cypher">GloBI Cypher Wiki</a>. </p>

</body>

</html>
